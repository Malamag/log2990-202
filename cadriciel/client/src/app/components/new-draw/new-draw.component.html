<div class="form-container">
    <h1>Nouveau dessin</h1>
    <div class="drawForm">
        <form [formGroup]="newDrawForm" (ngSubmit)="onSubmit()">
            <!--TODO: ng submit function-->

            <mat-form-field>
                <mat-label for="canvWidth">Largeur (px)</mat-label>
                <input matInput type="text" formControlName="canvWidth" [value]="width" (keydown)="blockEvent($event)">
            </mat-form-field>

            <mat-form-field>
                <mat-label for="canvHeight">Hauteur (px)</mat-label>
                <input matInput type="text" formControlName="canvHeight" [value]="height"
                    (keydown)="blockEvent($event)">
            </mat-form-field>

            <mat-form-field>
                <mat-label for="canvColor">Couleur (hex)</mat-label>
                <input matInput type="text" formControlName="canvColor" [value]="color">
            </mat-form-field>

            <p *ngIf="(canvWidth && canvWidth.invalid) || 
            (canvHeight && canvHeight.invalid)" class="warnMessage">
                <!--Cas géré si canv* est null-->
                Veuillez entrer un entier positif
            </p>
            <p *ngIf="canvColor && canvColor.invalid" class="warnMessage">
                Valeur hexadécimale invalide!
            </p>
            <svg width="180" heigth="200">
                <defs>
                    <linearGradient id="newDrawHue" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:hsl( 0, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="8.3%" style="stop-color:hsl( 30, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="16.6%" style="stop-color:hsl( 60, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="24.9%" style="stop-color:hsl( 90, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="33.2%" style="stop-color:hsl( 120, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="41.5%" style="stop-color:hsl( 150, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="49.8%" style="stop-color:hsl( 180, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="58.1%" style="stop-color:hsl( 210, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="66.4%" style="stop-color:hsl( 240, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="74.7%" style="stop-color:hsl( 270, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="83%" style="stop-color:hsl( 300, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="91.3%" style="stop-color:hsl( 330, 100%, 50% );stop-opacity: 1;"></stop>
                        <stop offset="100%" style="stop-color:hsl( 360, 100%, 50% );stop-opacity: 1;"></stop>
                    </linearGradient>
                    <linearGradient id="gradBlack" x1="0%" y1="100%" x2="0%" y2="0%">
                        <stop offset="0%" style="stop-color: black;stop-opacity: 1;"></stop>
                        <stop offset="100%" style="stop-color: black;stop-opacity: 0;"></stop>
                    </linearGradient>
                    <linearGradient id="newDrawSV" x1="100%" y1="0%" x2="0%" y2="0%">
                        <stop offset="0%" style="stop-color:rgb( 255, 0, 0 );stop-opacity: 1;"
                            [style.stop-color]="'hsl(' + hue + ', 100%, 50% )'"></stop>
                        <stop offset="100%" style="stop-color:white;stop-opacity: 1;"></stop>
                    </linearGradient>
                </defs>
                <rect x="0" [style.y]='offsetY' width="20" height="100" fill="url(#newDrawHue)"
                    (mousedown)="onMouseDownHue($event)" (mousemove)="hueSelect($event)"
                    (mouseleave)="hueSelect($event)" (mouseup)="onMouseUp()"></rect>
                <rect x="0" y="0" width="20" height='6' stroke="white" fill="none" [ngStyle]="hueCursorStyles">
                </rect>
                <rect [style.x]='offsetX' [style.y]='offsetY' [style.width]="svMaxValue" [style.height]="svMaxValue"
                    fill="url(#newDrawSV)" stroke="black"></rect>
                <rect [style.x]='offsetX' [style.y]='offsetY' [style.width]="svMaxValue" [style.height]="svMaxValue"
                    fill="url(#gradBlack)" stroke="black" (mousedown)="onMouseDownSV($event)"
                    (mousemove)="svSelect($event)" (mouseup)="onMouseUp()"></rect>
                <circle [style.cx]='offsetX' [style.cy]='offsetY' r="4" fill="none" stroke="white"
                    [ngStyle]="svCursorStyles">
                </circle>
                <rect x="130" y="10" width="10" height="10" [style.fill]="color" stroke="black"></rect>
            </svg>
            <!--<svg id="palette">
                <circle *ngFor="let attr of paletteArray" class="paletteElem"
                [style.cx]=attr.cx cy="12" r="12" [style.fill]=attr.color (click)="updateColor(attr.color)"></circle>
            </svg>-->

            <button mat-raised-button color="primary" id="submitButton" type="submit"
                [disabled]="newDrawForm.invalid">C'est parti!</button>

        </form>
        <div>
            <button mat-button id="quitButton" (click)="closeModalForm()">Cancel</button>
        </div>

    </div>

</div>